window.addEventListener("load",(()=>{const e=document.querySelectorAll("img"),t=Array.from(e).filter((e=>e.complete&&e.naturalWidth>0)).map((e=>e.src));chrome.runtime.sendMessage({images:t})})),chrome.runtime.onMessage.addListener(((e,t,l)=>{if(e.imageUpdate){const{imageUrl:t,consensus:l}=e.imageUpdate,o=parseFloat(l)/100;let a,n;o>=.66?(a="#ff0000",n="High AI Likelihood"):o>=.33?(a="#ffc107",n="Moderate AI Likelihood"):(a="#28a745",n="Low AI Likelihood"),document.querySelectorAll(`img[src="${t}"]`).forEach((e=>{e.parentElement&&(e.parentElement.style.position="relative");let t=e.parentElement.querySelector(".ai-overlay");t||(t=document.createElement("div"),t.className="ai-overlay",t.style.position="absolute",t.style.bottom="0",t.style.left="0",t.style.width="100%",t.style.backgroundColor="rgba(255, 255, 255, 0.8)",t.style.textAlign="center",t.style.fontSize="14px",t.style.fontWeight="bold",t.style.padding="2px 0",t.style.zIndex="9999",e.parentElement.appendChild(t)),t.textContent=`${n}: ${o.toFixed(2)}`,t.style.color=a}))}}));