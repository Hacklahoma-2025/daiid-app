window.addEventListener("load",(()=>{const e=document.querySelectorAll("img"),t=Array.from(e).filter((e=>e.complete&&e.naturalWidth>0)).map((e=>e.src));chrome.runtime.sendMessage({images:t})})),chrome.runtime.onMessage.addListener(((e,t,l)=>{if(e.imageUpdate){const{imageUrl:t,consensus:l}=e.imageUpdate,o=l;let n,a;o>=66?(n="#ff0000",a="High AI Likelihood"):o>=33?(n="#ffc107",a="Moderate AI Likelihood"):(n="#28a745",a="Low AI Likelihood"),document.querySelectorAll(`img[src="${t}"]`).forEach((e=>{e.parentElement&&(e.parentElement.style.position="relative");let t=e.parentElement.querySelector(".ai-overlay");t||(t=document.createElement("div"),t.className="ai-overlay",t.style.position="absolute",t.style.bottom="0",t.style.left="0",t.style.width="100%",t.style.backgroundColor="rgba(255, 255, 255, 0.8)",t.style.textAlign="center",t.style.fontSize="14px",t.style.fontWeight="bold",t.style.padding="2px 0",t.style.zIndex="9999",e.parentElement.appendChild(t)),t.textContent=`${a}: ${o}%`,t.style.color=n}))}}));